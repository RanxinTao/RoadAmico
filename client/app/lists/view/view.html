<div ng-include="'components/navbar/navbar.html'"></div>

<div class="list-view container">
  <ol class="breadcrumb">
    <li><a ui-sref="lists">Lists</a></li>
    <li class="active">{{list.name}}</li>
  </ol>

  <h1 ng-hide="editing">{{list.name}}</h1>
  <input type="text" class="form-control space-top-medium space-bottom-medium list-name"
         ng-model="list.name" ng-show="editing" ng-change="save()"
         ng-model-options="{ updateOn: 'default blur', debounce: {'default': 1250, 'blur': 0} }" />

  <!-- Controls -->
  <div ng-show="canEdit(list)">
    <button ng-click="editing = true" class="btn btn-ra-teal" ng-hide="editing"><i class="fa fa-pencil"></i> Edit</button>
    <button ng-click="editing = false" class="btn btn-ra-teal" ng-show="editing"><i class="fa fa-save"></i> I'm Done Editing</button>

    <!--<div ng-show="editing">-->
      <!--<button class="btn btn-ra-teal" ng-click="save()"><i class="fa fa-save"></i> Save</button>-->
    <!--</div>-->
  </div>

  <div class="new-entry" ng-show="editing">
    <h2>Add something to the list:</h2>
    <div class="tabs">
      <tabset justified="true">
        <tab heading="Place">
          Coming soon...
        </tab>
        <tab heading="Writing">
          <div text-angular ng-model="newEntry.text"></div>
        </tab>
        <tab heading="Media">
          <div media-selector ng-model="newEntry"></div>
        </tab>
      </tabset>

      <div class="buttons">
        <button class="btn btn-ra-teal" ng-click="add()"><i class="fa fa-plus"></i> Add</button>
      </div>
    </div>
  </div>

  <div ng-repeat="entry in list.entries" class="entry">
    <div class="edit-controls" ng-show="editing">
      <button ng-click="remove($index)" class="btn btn-ra-red btn-xs btn-block"><i class="fa fa-times"></i></button>
      <button ng-click="moveUp($index)" class="btn btn-ra-teal btn-xs btn-block"><i class="fa fa-arrow-up"></i></button>
      <button ng-click="moveDown($index)" class="btn btn-ra-teal btn-xs btn-block"><i class="fa fa-arrow-down"></i></button>
    </div>

    <!-- Display a place -->
    <div ng-if="entry.place" class="place">
      <div class="row">
        <div class="col-sm-3">
          <a ui-sref="place.view({id: entry.place._id})">
            <img ng-src="{{entry.place.photo}}" class="thumbnail" />
          </a>
        </div>

        <div class="col-sm-9">
          <div class="name space-bottom-small">
            <a ui-sref="place.view({id: entry.place._id})">{{entry.place.locationDetails.name}}</a>
            <div rating ng-model="entry.place.rating" state-on="['fa', 'fa-star']" state-off="['fa', 'fa-star-o']"
                 readonly="true" class="color-sunflower-dark space-left-large"></div>
          </div>

          <!-- Location -->
          <div class="row space-bottom-small" ng-show="entry.place.locationDetails.formatted_address">
            <div class="col-xs-1"><i class="fa fa-lg fa-map-marker"></i></div>
            <div class="col-xs-10">{{entry.place.locationDetails.formatted_address}}</div>
          </div>

          <!-- Phone -->
          <div class="row space-bottom-small" ng-show="entry.place.locationDetails.formatted_phone_number">
            <div class="col-xs-1"><i class="fa fa-lg fa-phone"></i></div>
            <div class="col-xs-10">{{entry.place.locationDetails.formatted_phone_number}}</div>
          </div>

          <!-- Website -->
          <div class="row space-bottom-small" ng-show="entry.place.locationDetails.website">
            <div class="col-xs-1"><i class="fa fa-lg fa-globe"></i></div>
            <div class="col-xs-10"><a href="{{entry.place.locationDetails.website}}">Website</a></div>
          </div>

          <!-- Google+ -->
          <div class="row space-bottom-small" ng-show="entry.place.locationDetails.url">
            <div class="col-xs-1"><i class="fa fa-lg fa-google-plus"></i></div>
            <div class="col-xs-10"><a href="{{entry.place.locationDetails.url}}">Google+ Page</a></div>
          </div>
        </div>
      </div>
    </div>

    <!-- Display rich text -->
    <div ng-if="entry.photo" class="row">
      <div class="col-sm-6 col-sm-offset-3">
        <div class="embed">
          <img ng-src="{{entry.photo}}" >
          <p>{{entry.text}}</p>
        </div>
      </div>
    </div>

    <!-- Display rich text -->
    <div ng-if="entry.text && !entry.photo" class="text">
      <div ng-hide="editing" ng-bind-html="entry.text"></div>
      <div ng-if="editing" text-angular ng-model="entry.text" ng-change="save()" ng-model-options="{ updateOn: 'blur' }"></div>
    </div>

    <!-- Display an embed -->
    <div ng-if="entry.embed">
      <div class="row">
        <div class="col-sm-6 col-sm-offset-3">
          <div embedded-media="entry.embed" class="embed"></div>
        </div>
      </div>
    </div>

  </div>
  <div ng-hide="list.entries.length">
    Nothing has been added to this list yet.
  </div>

</div>

<div ng-include="'components/footer/footer.html'"></div>
